"use strict"
function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t)
e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0})
var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o]
r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),_react=require("react"),_react2=_interopRequireDefault(_react)
require("./CrowMediaGallery.css")
var _crowLightboxReader=require("crow-lightbox-reader"),_crowLightboxReader2=_interopRequireDefault(_crowLightboxReader),CrowMediaGallery=function(e){function t(e){_classCallCheck(this,t)
var o=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))
return o.onSelect=e.onSelect||!1,o.onCustomClick=e.onCustomClick||!1,o.itemIndexClicked=null,o.settings=e.settings||{},o.showSelect=o.settings.showSelect||!0,o.debug=o.settings.debug||!1,o.nodes={thumb:[]},o.state={selectItem:!1,showLightBox:!1,showGallery:!0,poolItems:e.items||[]},o}return _inherits(t,e),_createClass(t,[{key:"componentWillReceiveProps",value:function(e){this.state.poolItems!=e.items&&this.setState({poolItems:e.items})}},{key:"console",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""
!1!==this.debug&&console.log(e)})},{key:"selectItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""
if(!1!==this.onSelect)return void this.onSelect(e)
!0!==e.isSelected?(e.isSelected=!0,this.setState({selectItem:!0})):(e.isSelected=!1,this.setState({selectItem:!1}))}},{key:"renderSlelectBtn",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""
return!1!==this.showSelect&&!0!==t.isSelected?_react2.default.createElement("div",{onClick:function(){e.selectItem(t)},className:"crow-gallery-check-btn"},_react2.default.createElement("span",{className:"check-symbol"},"✓")):!1!==t.isSelected?_react2.default.createElement("div",{onClick:function(){e.selectItem(t)},className:"crow-gallery-select-btn"},_react2.default.createElement("span",{className:"check-symbol"},"✓")):""==t?void this.console("Bug on CrowMediaGallery => renderSlelectBtn func || you need to pass not empty items into items props on crow-media-gallery"):void 0}},{key:"renderPoolItemsThumb",value:function(){var e=this
if(""!=this.state.poolItems){var t=[]
return this.state.poolItems.map(function(o,r){void 0!==e.renderVideoItemThumb(o,r)&&t.push(e.renderVideoItemThumb(o,r)),void 0!==e.renderImageItemThumb(o,r)&&t.push(e.renderImageItemThumb(o,r)),void 0!==e.renderAudioItemThumb(o,r)&&t.push(e.renderAudioItemThumb(o,r))}),t}return void this.console("Bug on CrowMediaGallery => renderPoolItemsThumb func || you need to pass not empty items into items props on crow-media-gallery")}},{key:"showLigthBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1]
if(!1!==this.onCustomClick)return void this.onCustomClick(e,t)
this.itemIndexClicked=t,this.setState({showLightBox:!0,showGallery:!1})}},{key:"renderVideoItemThumb",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments[1]
return"video"===t.type?_react2.default.createElement("li",{ref:function(t){e.nodes.thumb.push(t)},key:o.toString(),className:"pool-item"},this.renderSlelectBtn(t),_react2.default.createElement("video",{onClick:function(){e.showLigthBox(t,o)},src:t.src,width:t.thumbWidth,height:t.thumbHeight,onPlay:function(e){e.preventDefault()}})):""==t.type||void 0==t.type?void this.console("Bug on CrowMediaGallery => renderVideoItemThumb func || you need to write type ('video', 'image', 'song') property in items pool "):void 0}},{key:"renderImageItemThumb",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments[1]
return"image"===t.type?_react2.default.createElement("li",{ref:function(t){e.nodes.thumb.push(t)},key:o.toString(),className:"pool-item"},this.renderSlelectBtn(t),_react2.default.createElement("img",{onClick:function(){e.showLigthBox(t,o)},src:t.src,width:t.thumbWidth,height:t.thumbHeight,alt:t.alt})):""==t.type||void 0==t.type?void this.console("Bug on CrowMediaGallery => renderImageItemThumb func || you need to write type ('video', 'image', 'song') property in items pool "):void 0}},{key:"renderAudioItemThumb",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments[1]
return"audio"===t.type?_react2.default.createElement("li",{ref:function(t){e.nodes.thumb.push(t)},key:o.toString(),className:"pool-item"},this.renderSlelectBtn(t),_react2.default.createElement("img",{src:t.thumbSrc,width:t.thumbWidth,height:t.thumbHeight,alt:"thumbnail of audio content",onClick:function(){e.showLigthBox(t,o)}})):""==t.type||void 0==t.type?void this.console("Bug on CrowMediaGallery => renderAudioItemThumb func || you need to write type ('video', 'image', 'song') property in items pool "):void 0}},{key:"renderPoolListThumb",value:function(){if(!1!==this.state.showGallery)return _react2.default.createElement("ul",{key:"r1",className:"crow-media-gallery-pool-list"},this.renderPoolItemsThumb())}},{key:"renderLightBoxReader",value:function(){var e=this,t={showPool:!0,showBtn:!0,showDesc:!0,showLightBox:this.state.showLightBox,nodeToHide:!1,debug:!1}
if(!1!==this.state.showLightBox)return _react2.default.createElement(_crowLightboxReader2.default,{closeCallBack:function(){e.setState({showLightBox:!1,showGallery:!0})},isRead:this.itemIndexClicked,items:this.state.poolItems,settings:t})}},{key:"showRenderer",value:function(){var e=[]
return e.push(this.renderPoolListThumb()),!1!==this.state.showGallery?_react2.default.createElement("div",null,_react2.default.createElement("div",{className:"crow-media-gallery"},e)):_react2.default.createElement("div",null,this.renderLightBoxReader())}},{key:"render",value:function(){return this.showRenderer()}}]),t}(_react.Component)
exports.default=CrowMediaGallery
